HW2
================
Eric Xu
2025-09-23

to store the local data files, and use relative paths to access these
data files `"./Data/"`

## Problem 1

Data cleaning from csv files `snp` and `pol_month`, tidy and transpose
the `unemployment` file

``` r
pol_month = read_csv("./Data/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate(mon,sep = "-",
           into = c("year","month","day")) |> 
  mutate(
    year = as.integer(year),
    day = as.integer(day),
    month = as.integer(month),
    month = month.abb[month],
    president = case_when(prez_gop != 0 ~ "gop",
                          prez_dem != 0 ~ "dem")
    ) |> 
  select(-prez_gop, 
         -prez_dem, 
         -day
         )
snp = read_csv("./Data/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date,
           sep = "/",
           into = c("month","day","year")) |> 
  mutate(
    year = as.integer(year),
    day = as.integer(day),
    month_num = as.integer(month),
    month = month.abb[month_num],
    year = case_when(
      year < 50 ~ 2000L + year,
      year >= 50 ~ 1900L + year
      )
    ) |> 
  select(year,month,everything()) |> 
  arrange(year,month_num)|> 
  select(-day,
         -month_num
         )

unemployment = read_csv("./Data/unemployment.csv") |> 
  pivot_longer(
    Jan:Dec,
    values_to = "unemployment_rate",
    names_to = "month" 
    ) |> 
  rename(
    year = Year
  )
```

merge data with the same year and month variable:

``` r
anti_join(snp,pol_month, by = c("year","month"))
```

    ## # A tibble: 1 × 3
    ##    year month close
    ##   <int> <chr> <dbl>
    ## 1  2015 Jul   2080.

``` r
anti_join(pol_month,snp, by = c("year","month"))
```

    ## # A tibble: 36 × 9
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 Jan        23      51     253      23      45     198 dem      
    ##  2  1947 Feb        23      51     253      23      45     198 dem      
    ##  3  1947 Mar        23      51     253      23      45     198 dem      
    ##  4  1947 Apr        23      51     253      23      45     198 dem      
    ##  5  1947 May        23      51     253      23      45     198 dem      
    ##  6  1947 Jun        23      51     253      23      45     198 dem      
    ##  7  1947 Jul        23      51     253      23      45     198 dem      
    ##  8  1947 Aug        23      51     253      23      45     198 dem      
    ##  9  1947 Sep        23      51     253      23      45     198 dem      
    ## 10  1947 Oct        23      51     253      23      45     198 dem      
    ## # ℹ 26 more rows

``` r
anti_join(unemployment,pol_month, by = c("year","month"))
```

    ## # A tibble: 6 × 3
    ##    year month unemployment_rate
    ##   <dbl> <chr>             <dbl>
    ## 1  2015 Jul                  NA
    ## 2  2015 Aug                  NA
    ## 3  2015 Sep                  NA
    ## 4  2015 Oct                  NA
    ## 5  2015 Nov                  NA
    ## 6  2015 Dec                  NA

``` r
joint = left_join(pol_month,snp, by = c("year","month")) |> 
  left_join(unemployment, by = c("year","month"))
```

**Descriptive data of `joint`:**

``` r
skimr::skim(joint)
```

|                                                  |       |
|:-------------------------------------------------|:------|
| Name                                             | joint |
| Number of rows                                   | 822   |
| Number of columns                                | 11    |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_   |       |
| Column type frequency:                           |       |
| character                                        | 2     |
| numeric                                          | 9     |
| \_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_ |       |
| Group variables                                  | None  |

Data summary

**Variable type: character**

| skim_variable | n_missing | complete_rate | min | max | empty | n_unique | whitespace |
|:--------------|----------:|--------------:|----:|----:|------:|---------:|-----------:|
| month         |         0 |             1 |   3 |   3 |     0 |       12 |          0 |
| president     |         0 |             1 |   3 |   3 |     0 |        2 |          0 |

**Variable type: numeric**

| skim_variable | n_missing | complete_rate | mean | sd | p0 | p25 | p50 | p75 | p100 | hist |
|:---|---:|---:|---:|---:|---:|---:|---:|---:|---:|:---|
| year | 0 | 1.00 | 1980.75 | 19.79 | 1947.00 | 1964.00 | 1981.00 | 1998.00 | 2015.00 | ▇▇▇▇▇ |
| gov_gop | 0 | 1.00 | 22.48 | 5.68 | 12.00 | 18.00 | 22.00 | 28.00 | 34.00 | ▆▆▇▅▅ |
| sen_gop | 0 | 1.00 | 46.10 | 6.38 | 32.00 | 42.00 | 46.00 | 51.00 | 56.00 | ▃▃▇▇▇ |
| rep_gop | 0 | 1.00 | 194.92 | 29.24 | 141.00 | 176.00 | 195.00 | 222.00 | 253.00 | ▃▇▆▃▅ |
| gov_dem | 0 | 1.00 | 27.20 | 5.94 | 17.00 | 22.00 | 28.00 | 32.00 | 41.00 | ▆▅▇▆▂ |
| sen_dem | 0 | 1.00 | 54.41 | 7.37 | 44.00 | 48.00 | 53.00 | 58.00 | 71.00 | ▇▆▇▃▂ |
| rep_dem | 0 | 1.00 | 244.97 | 31.37 | 188.00 | 211.00 | 250.00 | 268.00 | 301.00 | ▇▂▇▇▅ |
| close | 36 | 0.96 | 472.85 | 543.29 | 17.05 | 83.67 | 137.26 | 932.06 | 2107.39 | ▇▁▂▁▁ |
| unemployment_rate | 12 | 0.99 | 5.83 | 1.65 | 2.50 | 4.70 | 5.60 | 6.90 | 10.80 | ▃▇▅▂▁ |

``` r
names(joint)
```

    ##  [1] "year"              "month"             "gov_gop"          
    ##  [4] "sen_gop"           "rep_gop"           "gov_dem"          
    ##  [7] "sen_dem"           "rep_dem"           "president"        
    ## [10] "close"             "unemployment_rate"

``` r
joint |> 
  ggplot(aes(x = year, y = unemployment_rate, color = president)) +
  geom_point(na.rm = TRUE) +
  labs(
    title = "Average Monthly Unemployment Rate Over Time",
    y = "Unemployment Rate (%)",
    x = "Year"
  ) +
  scale_x_continuous(n.breaks = 10)+
  theme(
    plot.title = element_text(hjust = 0.5, size = 18),
    axis.title = element_text(size = 14, ),
    axis.text = element_text(size = 12)
    )
```

![](p8105_hw2_sx2402_files/figure-gfm/plot%20and%20descriptive%20data-1.png)<!-- -->

``` r
joint |> 
  ggplot(aes(x = year, y = close, color = president)) +
  geom_point(na.rm = TRUE) +
  labs(
    title = "S&P Closing Value over Time",
    x = "Year",
    y = "closing Values S&P"
  ) +  
  scale_x_continuous(n.breaks = 10)+
  theme(
    plot.title = element_text(hjust = 0.5, size = 18),
    axis.title = element_text(size = 14, ),
    axis.text = element_text(size = 12)
    )
```

![](p8105_hw2_sx2402_files/figure-gfm/plot%20and%20descriptive%20data-2.png)<!-- -->

The dataset `joint` combines information from `pols-month`, `snp`, and
`unemployment`. The original files tracked the partisan composition of
U.S. politics from 1947 to 2015, along with an indicator for the sitting
president. The `snp` file contained monthly closing values of the S&P
500 stock index from 1950 to 2015, the mean value is 472.8470595, with a
standard deviation of 543.2899518. while the unemployment file provided
national unemployment rates is 1948 to 2015 by month. After cleaning and
aligning by year and month, the merged dataset `joint` has 822 rows and
11 columns, covering the period 1947 to 2015. On average, unemployment
was 5.83%, S&P closing values ranged within 17.049999 and 2107.389893.
The overall paragraph shows an increasing trend of unemployment rate and
S&P closing value. The colored president political party demonstrated a
fluctuation of closing value after 2000 and spiking of unemployment rate
after 1980 when president is GOP. This data only shows association by
time and president political party, and the association is not examined
by other covariates.
